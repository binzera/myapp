extends ../layout

block content
  .container.mt-5
    h1 Editar Comércio de Animais
    div(value=comercioAnimais.get('comprador').id)
    .form-container
      form(action=`/comercio_animais/${comercioAnimais.id}/edit` method="POST")
        .form-group
          label(for="data") Data
          input#data.form-control.mb-2(type="date" name="data" value=comercioAnimais.get('data').toISOString().split('T')[0] required)
        .form-group
          label(for="tipo") Tipo
          select.form-select.mb-2(name="tipo" id="tipo" required)
            option(value="") Selecione o Tipo
            option(value="Compra" selected=(comercioAnimais.get('tipo') == 'Compra')) Compra
            option(value="Venda" selected=(comercioAnimais.get('tipo') == 'Venda')) Venda
        .form-group
          label(for="sexo") Sexo
          select.form-select.mb-2(name="sexo" required)
            option(value="") Selecione o Sexo
            option(value="Macho" selected=(comercioAnimais.get('sexo') == 'Macho')) Macho
            option(value="Fêmea" selected=(comercioAnimais.get('sexo') == 'Fêmea')) Fêmea
        .form-group
          label(for="vendedor") Vendedor
          select#vendedor.form-select.mb-2(name="vendedor" required style="flex:1; ")
            option(value="") Selecione o Vendedor
            each pessoa in pessoas
              option(
                value=pessoa.id 
                data-tipo=pessoa.get('tipo') 
                selected=(comercioAnimais.get('vendedor') && pessoa.id === comercioAnimais.get('vendedor'))
              )= pessoa.get('nome')
        .form-group
          label(for="comprador") Comprador
          select#comprador.form-select.mb-2(name="comprador" required)
            option(value="") Selecione o comprador
            each pessoa in pessoas
              option(
                value=pessoa.id 
                data-tipo=pessoa.get('tipo')
                selected=(comercioAnimais.get('comprador') && pessoa.id === comercioAnimais.get('comprador'))
              )= pessoa.get('nome')
        .form-group
          label(for="quantidade") Quantidade
          input#quantidade.form-control.mb-2(type="number" name="quantidade" value=comercioAnimais.get('quantidade') required)
        .form-group
          label(for="valor") Valor
          input#valor.form-control.mb-2(type="number" step="0.01" name="valor" value=comercioAnimais.get('valor') required)
        .form-group
          label(for="peso") Peso
          input#peso.form-control.mb-2(type="number" step="0.01" name="peso" value=comercioAnimais.get('peso') required)
        .form-group
          label(for="idade") Idade
          select#idade.form-control(name="idade" required)
            option(value="") Selecione a Idade
            option(value="0-12") 0-12 meses
            option(value="13-24") 13-24 meses
            option(value="25-36") 25-36 meses
            option(value="+36") Acima de 36 meses
        .form-group.mt-3
          button.btn.btn-secondary(type="button" onclick="window.location.href='/comercio_animais'" style="display:inline; margin-right: 5px;") Voltar
          button.btn.btn-primary(type="submit") Salvar

    // Script para definir a idade automaticamente
    script.
      document.addEventListener('DOMContentLoaded', function() {
        var idade = "#{comercioAnimais.get('idade')}";
        var idadeDropdown = document.getElementById('idade');
        for (var i = 0; i < idadeDropdown.options.length; i++) {
          console.log(idadeDropdown.options[i].value + ' - ' + idade);
          if (idadeDropdown.options[i].value === idade) {
            idadeDropdown.options[i].selected = true;
            break;
          }
        }
      });
